\documentclass{amsart}

\textheight=22.5cm
\topmargin=0.5cm

\usepackage{amssymb}
\usepackage{graphicx,color}
\usepackage{amsmath}
\usepackage{url}
\usepackage[colorlinks=true]{hyperref}

\usepackage{cleveref}
\Crefname{counterexample}{counterexample}{counterexamples}
\Crefname{counterexample}{Counterexample}{Counterexamples}
\Crefname{conjecture}{conjecture}{conjectures}
\Crefname{conjecture}{Conjecture}{Conjectures}


\usepackage{tikz-cd}
\usepackage{tikz}
\usetikzlibrary{matrix}



\newcommand{\limites}{}

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{notation}[theorem]{Notation}
\newtheorem{example}[theorem]{Example}
\newtheorem{problem}[theorem]{Problem}
\newtheorem{question}[theorem]{Question}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{remark}[theorem]{Remark}


% Macros in general

\newcommand{\F}{ \ensuremath{\mathbb{F}}}
\newcommand{\N}{ \ensuremath{\mathbb{N}}}
\newcommand{\Z}{ \ensuremath{\mathbb{Z}}}
\newcommand{\C}{ \ensuremath{\mathbb{C}}}
\newcommand{\R}{ \ensuremath{\mathbb{R}}}

\newcommand{\bb}{{\mathbf{b}}}
\newcommand{\cc}{{\mathbf{c}}}
\newcommand{\ttt}{\mathbf{t}}
\newcommand{\GL}{{GL}_r (K)}
\newcommand{\Gin}{\ensuremath{\mathrm{Gin}}}
\newcommand{\gin}{\ensuremath{\mathrm{gin}}}
\newcommand{\GIN}{\ensuremath{\mathrm{GIN}}}
\newcommand{\Gins}{\ensuremath{\mathrm{Gins}}}
\newcommand{\gins}{\ensuremath{\mathrm{gins}}}
\newcommand{\Lex}{\ensuremath{\mathrm{Lex}}}
\newcommand{\dele}[1]{\ensuremath{\Delta^e({#1})}}
\newcommand{\dels}[1]{\ensuremath{\Delta^s({#1})}}
\newcommand{\delc}[1]{\ensuremath{\Delta^c({#1})}}
\newcommand{\Shift}{\ensuremath{\mathrm{Shift}}}


\renewcommand{\int}{\operatorname{int}}
\newcommand{\width}{\operatorname{width}}
\newcommand{\length}{\operatorname{length}}


\newcommand{\cone}{\ensuremath{\mathrm{cone}}\hspace{1pt}}
\newcommand{\conv}{\ensuremath{\mathrm{conv}}\hspace{1pt}}
\newcommand{\cayley}{\operatorname{Cay}}
\newcommand{\rank}{\operatorname{rank}}
\newcommand{\reg}{\operatorname{reg}}
\newcommand{\depth}{\operatorname{depth}}

\newcommand{\Image}{\ensuremath{\mathrm{Im}}\hspace{1pt}}

\usepackage[colorinlistoftodos]{todonotes}

\newcommand{\giulia}[1]{\todo[size=\tiny,color=blue!30]{#1 \\ \hfill --- G.}}
\newcommand{\Giulia}[1]{\todo[size=\tiny,inline,color=blue!30]{#1 \\ \hfill --- G.}}

\newcommand{\paco}[1]{\todo[size=\tiny,color=green!30]{#1 \\ \hfill --- P.}}
\newcommand{\Paco}[1]{\todo[size=\tiny,inline,color=green!30]{#1 \\ \hfill --- P.}}



\date{\today}

\author[G.~Codenotti]{Giulia Codenotti}
\author[F.~Santos]{Francisco Santos}

\address[G.~Codenotti]
{
Institut f\"ur Mathematik, Freie Universit\"at Berlin, Germany
}
\email{giulia.codenotti@fu-berlin.de}

\address[F.~Santos]
{
Department of Mathematics, Statistics and Computer Science, University of Cantabria, Spain
}
\email{francisco.santos@unican.es}

\thanks{The authors were supported by the Einstein Foundation Berlin under grant EVF-2015-230. 
Work of F. Santos is also supported by project MTM2017-83750-P of the Spanish Ministry of Science (AEI/FEDER, UE)}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{Unimodular covers of 3-dimensional parallelepipeds and Cayley sums}

\begin{document}

\begin{abstract}
We show that the following classes of three-dimensional lattice polytopes have unimodular covers: the class of all parallelepipeds, the class of all centrally symmetric polytopes, and the class of all three-dimensional Cayley sums $\cayley(P,Q)$ where the normal fan of $Q$ refines that of $P$. This improves results of Beck et al. (2018) and Haase et al. (2008) where the last two classes were shown to be IDP.
\end{abstract}

\maketitle

\section{Introduction}

A lattice polytope $P\subset \R^d$ has the \emph{integer decomposition property} if for every positive integer $n$, every lattice point $p \in nP\cap \Z^d$ can be written as a sum of $n$ lattice points in $P$. We abbreviate this by saying that ``$P$ is IDP''. Being IDP is interesting in the context of  both enumerative combinatorics (Ehrhart theory) and algebraic geometry (normality of toric varieties) and it falls into a hierarchy of several properties each stronger than the previous one. See, e.g., \cite[Sect. 1.2.5]{HPPS-survey}, \cite[p. 2097f]{mfo2004}, \cite[p. 2313f]{mfo2007}.
\paco{cite Bruns-Gubeladze book?}
Let us here only mention that
\[
P \text{ has a unimodular triangulation}\Rightarrow
P \text{ has a unimodular cover}\Rightarrow
P \text{ is IDP.}
\]
Remember that a \emph{unimodular triangulation} is a triangulation of $P$ into unimodular simplices, and a \emph{unimodular cover} is a collection of unimodular simplices whose union equals $P$. 

\paco{define mixed IDP, Cayley sums, Minkowski sums, mixed subdivisions}
A lattice polytope is called \emph{smooth} if it is simple and the edge generators at every vertex form a linear basis for the lattice. 
%
Oda~\cite{Oda1997} posed several questions regarding IDP polytopes which are now considered conjectures (REFERENCES). 
Among them:
\begin{conjecture}
\label{conj:Oda}
\begin{enumerate}
\item (Problems 3 and 4 in \cite{Oda1997}) Let $P, Q\subset \R^d$ be lattice polytopes with the normal fan of $Q$ refining that of $P$, and $P$ smooth. Then
\begin{align*}
\label{eq:mixedIDP}
(P+Q) \cap \Z^d = P \cap \Z^d + Q \cap \Z^d.
\end{align*}
\paco{perhaps we can call this formula ``being mixed IDP''. The property of ``$N(Q)$ refines $N(P)$'' is sometimes called ``$P$ is a Minkowski summand of $Q$''.}

\item Every smooth lattice polytope is IDP.
\end{enumerate}
\end{conjecture}

Motivated by these and other questions, several authors have studied the IDP property for different classes of lattice polytopes. 

For example,  very recently
Beck et al.~\cite{BHHHJKM2019} proved that all smooth centrally symmetric $3$-polytopes are IDP.
More precisely, they show that any such polytope can be covered by lattice 
parallelepipeds and unimodular simplices, both of which are trivially IDP.

Partially motivated by this result in \Cref{sec:parallelepipeds} we show:

\begin{theorem}
\label{thm:parallelepipeds}
Every $3$-dimensional lattice parallelepiped has a unimodular cover.
\end{theorem}

As a consequence:

\begin{corollary}
\label{coro:3cs}
Every smooth centrally symmetric lattice $3$-polytope has a unimodular cover. 
\qed
\end{corollary}

\begin{question}
Do $3$-dimensional parallelepipeds have unimodular triangulations?
\end{question}

\begin{question}
Higher dimensional parallelotopes (affine images of cubes) are IDP. Do they have unimodular covers? 
\end{question}

%\begin{proof}
%Let $P$ be a smooth centrally symmetric lattice $3$-polytope.
%Beck et al.~\cite{BHHHJKM2019} show that $P$ is IDP by covering it with parallelepipeds and unimodular simplices. Once we know parallelepipeds have unimodular covers (\Cref{thm:parallelepipeds}), we conclude $P$ has a unimodular cover too.
%\end{proof}

Another case of Oda's questions that has been solved is the two-dimensional case of \Cref{conj:Oda}(1), with three different proofs by
Fakhruddin~\cite{Fakhruddin}, Ogata~\cite{Ogata} and Haase et al.~\cite{HNPS2008}, the latter without assuming $P$ smooth. 
In dimension three however the statement fails without the smoothness assumptin, as shown by letting $P=Q$ be the empty simplex of volume two.

An alternative approach to \Cref{conj:Oda}(1) is via Cayley sums. As we note in \Cref{sec:cayley} (\Cref{prop:mixedIDP}), if $P,Q\subset \R^d$ are two lattice polytopes one has
\[
\cayley(P,Q) \text{ is IDP} 
\Rightarrow
(P+Q) \cap \Z^d = P \cap \Z^d + Q \cap \Z^d.
\]
In \Cref{sec:cayley} we show the following even stronger result, in the two-dimensional case:

\begin{theorem}
\label{thm:cayley}
Let $P$ and $Q$ be lattice polygons with the normal fan of $Q$ refining that of $P$. Then the Cayley sum $\cayley(P,Q)$ has a unimodular cover.
\end{theorem}

As an application of this, we prove \Cref{conj:Oda}(2) for $3$-dimensional \emph{prismatoids}, polytopes whose vertices all lie in two parallel facets:

\begin{corollary}
\label{coro:prismatoid}
Every smooth $3$-dimensional lattice prismatoid has a unimodular cover.
\end{corollary}

We believe that the $3$-polytopes in these four statements all have unimodular triangulations, but we do not have a proof.


\subsection*{Acknowledgements:} We thank Akiyoshi Tsuchiya, Spencer Backman, Gaku Liu, Johannes Hofscheier, Christian Haase, .... et al.

%\section{Preliminaries}
%\label{sec:prelim}


\section{Parallelepipeds}
\label{sec:parallelepipeds}

The main tool is what I call the parallelepiped circumscribed to a given tetrahedron, defined as follows:

\begin{definition}
Definition: Let $T$ be a tetrahedron with vertex set $p_1,p_2,p_3,p_4$. Consider points $q_1,q_2,q_3,q_4$ defined as $q_i= \frac12 (p_1+p_2+p_3+p_4) - p_i$ and let $S$ be the convex hull of the $p_i$s and the $q_i$s. $S$ is called the \emph{parallelepiped circumscribed} to $T$.
\end{definition}
\paco{define the ``corner tetrahedra''}

The idea to have in mind is that of the regular tetrahedron inscribed in a cube. Modulo an affine transformation this is exactly the situation of $T$ and $S$.

Some properties of this construction:

1) $S$ is ``half a fundamental domain'' for the affine lattice $\Lambda_P$ generated by $p_1,\dots,p_4$, in the following precise sense: if $x$ is an arbitrary point, then $S$ intersects either $\Lambda_P + x$ or $\Lambda_P -x$ (and, if $x$ is generic then the intersection is unique). Proof: think of this property for the standard cube and the lattice $\{sum of coordinates is even\}$ generated by the vertices of the regular tetrahedron inscribed in it. (Remark: let us assume without loss of generality that $\Lambda_P$ contains the origin, so that $\Lambda + x$ is the class of $x$ modulo $\Lambda$).


\begin{lemma}
\label{lemma:corner}
Let $T=\conv\{p_1,p_2,p_3,p_4\}$ be lattice tetrahedron and $C(T)$ be the parallelepiped circumscribed to $T$. Let $T_1, T_2,T_3$ and $T_4$ be the corresponding corner tetrahedra in $C(T)$. Then, every $T_i$ contains at least one lattice point different from $\{p_1,\dots,p_4\}$.
\end{lemma}

\begin{proof}
%2) As a corollary, if $T$ is a non-unimodular lattice tetrahedron with respect to a certain lattice $\Lambda$ then $S$ contains some additional lattice point $p_5$. Proof: since $T$ is not unimodular, there is a lattice point $x \in \Lambda \setminus \Lambda_P$. Then either $x + \Lambda_P$ or $x-\Lambda_P$ contains the desired lattice point.
%
%3) Even more so, if $T$ is a non-unimodular   **empty**  lattice tetrahedron then each of the four ``corner tetrahedraï¿½ï¿½F in $S$ (the tetrahedra $\conv(p_i,p_j,p_k,q_l\}$ where $\{i,j,k,l\}= \{1,2,3,4\}$) contains a lattice point $x \in \Lambda \setminus \Lambda_P$. Proof: 
This requires using the classification of empty tetrahedra, which can be rephrased as follows: let $T$ be an empty tetrahedron and consider the tiling of 3-space by copies of $T$, its opposite, and octahedra. (Think of the tiling of $\R^3$ by hyperplanes of the form $\pm x \pm y \pm z = even$). Then, all lattice points lie in parallelograms that divide the octahedra in two. Moreover, the lattice points in each of the parallelograms are a discrete cyclic group of the torus obtained gluing opposite sides of it. The key property now is that one fourth of the fundamental parallelogram goes to each of the corner tetrahedra (where by 'one fourth' I mean the triangle obtained joining the center of the parallelogram of one of the edges). And, by the classification of empty tetrahedra, each of these fourths of parallelogram necessarily contains at least a lattice point of $\Lambda \setminus \Lambda_P$. (This last assertion is essentially Lemma 3.2(2) in my paper with Monica https://arxiv.org/abs/1409.6701).
\end{proof}


\begin{lemma}
\label{lemma:3<4}
Let $P$ be a lattice parallelepiped and let $T\subset P$ be an empty tetrahedron. Then, at least one of the four corner tetrahedra in $C(T)$ is fully contained in $P$.
\end{lemma}

\begin{proof}
\paco{fill in details...}
Each of the three pairs of parallel facets of $P$ cuts out at most one of the four new vertices in $C(T)$.
\end{proof}


\begin{proof}[Proof of \Cref{thm:parallelepipeds}]
\paco{rewrite}
4) For every point $p_5 \in S \setminus T$ we have that $\conv(T\cup \{p_5\})$ can be triangulated into three tetrahedra of volume strictly smaller than that of $T$. Proof: $S$ is naturally divided into five tetrahedra: $T$ plus the four ``corner tetrahedra'' $\conv(p_i,p_j,p_k,q_l\}$ where $\{i,j,k,l\}= \{1,2,3,4\}$. Suppose wlog that $p_5 \in \conv(p_1,p_2,p_3, q_4)$. Then $\conv(T\cup \{p_5\})$ can be triangulated into 
\[
\conv(p_1,p_2,p_4, p_5),
\conv(p_1,p_3,p_4, p_5),
\conv(p_2,p_3,p_4, p_5).
\]

Putting these properties together we get the following: Let us say that a lattice $3$-polytope $P$ \emph{has the circumscribed parallelepiped property} if: ``for every empty tetrahedron $T$ contained in $P$ at least one of the other four vertices of the circumscribed parallelepiped $S$ is also in $P$''.

Theorem: Every lattice polytope with the circumscribed parallelepiped property has a unimodular cover.

Proof: triangulate $P$ into empty simplices and iteratively apply properties (3) and (4) to them. This allows to cover every non-unimudular lattice simplex contained in $P$ with lattice simplices of smaller volume, until you cover by unimodular ones. QED
\end{proof}

\begin{remark}
\label{rem:octahedra_and_tri-prisms}
Let us say that a lattice $3$-polytope $P$ \emph{has the circumscribed parallelepiped property} if it satisfies the conclusion of \Cref{lemma:3<4}:  ``for every empty tetrahedron $T$ contained in $P$ at least one of the four corner tetrahedra in $C(T)$ is 
contained in $P$''. Then, $P$ has a unimodular cover, since the proof of \Cref{thm:parallelepipeds} works for $P$.

In turn, our proof of \Cref{lemma:3<4} relies on the fact that parallelepipeds have only three (pairs of) normal vectors. The proof fails if $P$ has four of them, as the following non-IDP octahedron and triangular prism show:
\[
\text{ write the octa and tri prism}.
\]
In both cases, the only lattice points are the six vertices and the origin. The point $(1,1,1)$ lies in the second dilation but is not the sum of two lattice points in the polytope.
\end{remark}

\begin{question}
Does every smooth 3-polytope have the circumscribed parallelepiped property? By the above remark, if the answer is yes then every smooth $3$-polytope has a unimodular cover.
\end{question}


\section{nef Cayley sums}
\label{sec:cayley}

Throughout this section let $P$ and $Q$ be two lattice polytopes in $\R^d$. We do not require them to be full-dimensional, but we assume their Minkowski sum is. Remember that the Minkowski sum $P+Q$ of $P$ and $Q$ is defined as:
\[
P + Q := \{ p+q \in \R^d: p\in P, q \in Q\}.
\]
The \emph{Cayley sum} of $P$ and $Q$ is defined as
\[
\cayley (P,Q) = \conv( P\times\{0\} \cup Q\times \{1\}) \in \R^{d+1}.
\]
The assumption that $P+Q$ is $d$-dimensional is equivalent to $\cayley (P,Q)$ is a $(d+1)$-dimensional.

We introduce the following two concepts.

\begin{definition}
In the above conditions, we say that $Q$ \emph{is nef for $P$} if the normal fan of $Q$ refines that of $P$. If this happens, we say that $\cayley(P,Q)$ is a \emph{nef Cayley sum}.

We say that the pair $(P,Q)$ is \emph{mixed IDP} if 
\paco{``mixed IDP'' is not the right property, since this is weaker than IDP}
\[
(P\cap \Z^d) + (Q\cap \Z^d) = (P+Q)\cap \Z^d.
\]
\end{definition}

In this language, \Cref{conj:Oda}(1) translates to:
\emph{If $Q$ is nef for $P$ and $P$ is smooth then the pair $(P,Q)$ mixed IDP.}


\begin{proposition}
\label{prop:mixedIDP}
If $\cayley(P,Q)$ is IDP then the pair $(P,Q)$ is mixed IDP.
\end{proposition}

The so-called \emph{Cayley Trick} is the isomorphism
\[
2\cayley(P, Q) \cap (\R^d\times \{1\}) \cong P+Q,
\]
which induces the following canonical bijections:
\begin{align*}
\text{polyhedral subdivisions of $\cayley(P,Q)$} &\leftrightarrow \text{mixed subdivisions of $P + Q$}\\
\text{triangulations of $\cayley(P,Q)$} &\leftrightarrow \text{fine mixed subdivisions of $P + Q$}\\
\text{unimodular simplices in $\cayley(P,Q)$} &\leftrightarrow \text{unimodular prod-simplices in $P + Q$}.
\end{align*}
See \cite{DLRS2010} for more details on the Cayley Trick and on triangulations and polyhedral subdivisions of polytopes.
In fact these bijections can be taken as definitions of the objects in the right-hand sides. In particular, 
we call \emph{prod-simplices} in $P+Q$ the Minkowski sums $T_1+T_2$ where $T_1\subset P$ and $T_2\subset Q$ are simplices with complementary affine spans. A prod-simplex is \emph{unimodular} if the edge vectors from a vertex of $T_1$ and from a vertex of $T_2$ form a unimodular basis.

%As a consequence, we also have that:
%\begin{align*}
%\text{$\cayley(P,Q)$ has a unimodular cover} &\leftrightarrow \text{$P+Q$ can be covered by unimodular prod-simplices}.
%\end{align*}

Our proof of \Cref{thm:cayley} is based on the following result:

\begin{lemma}
\label{lemma:cayley}
Let $P$ and $Q$ be two lattice polygons with $Q$ nef with respect to $P$. Let $p_1p_2 \subset P$ and $q_1q_2\subset Q$ be two primitive and non-parallel segments, and assume that the prod-simplex (parallelogram)  $p_1p_2 + q_1q_2$ is not unimodular. Then,
at least one of the strips
\paco{add picture for these strips, and perhaps for the proof}
\[
(p_1p_2 + \langle \overrightarrow{q_1q_2}\rangle) \cap P
\qquad \text{and} \qquad
(q_1q_2 + \langle \overrightarrow{p_1p_2}\rangle) \cap Q
\]
has a lattice point in its interior.
\end{lemma}

\begin{proof}
To DO
\end{proof}

\begin{proof}[Proof of \Cref{thm:cayley}]
TO DO 
\end{proof}

\Cref{coro:prismatoid} is a particular case of the following situation. 
Let $Q_1$ and $Q_2$ be two polygons and consider the prismatoid 
\[
P= \conv(Q_1\times\{0\} \cup Q_2 \times \{k\},
\]
with $k\ge 2$. 
%Assume that $P\cap(\R^2\times\{i\})$ is a lattice polytope for every $i=0,\dots, k$. This is equivalent to assuming that $P\cap(\R^2\times\{1\})$ is a lattice polytope:

\begin{corollary}
If $P\cap(\R^2\times\{1\})$ is a lattice polygon then $P$ has a unimodular cover.
\end{corollary}

\begin{proof}
\paco{perhaps add details}
The condition that $P\cap(\R^2\times\{1\})$ is a lattice polygon implies the same for $P\cap(\R^2\times\{i\})$, for every $i$.
Then, each slice
\[
P \cap (\R^2\times[i,i+1])
\]
is a nef Cayley polytope, hence it has a unimodular cover by \Cref{thm:cayley}.
\end{proof}


\begin{thebibliography}{99}

\bibitem{BHHHJKM2019}
Matthias Beck, Christian Haase, Akihiro Higashitani, Johannes Hofscheier, Katharina Jochemko, Lukas Katth\"an, Mateusz Micha{\l}ek,
Smooth Centrally Symmetric Polytopes in Dimension 3 are IDP,
\emph{Ann.~Combin.}, in press, 2019.
\url{https://doi.org/10.1007/s00026-019-00418-x}

\bibitem{DLRS2010}
J. A. De Loera, J. Rambau, F. Santos
Triangulations: Structures for Algorithms and Applications, 539 pp.
Algorithms and Computation in Mathematics, Vol. 25, Springer-Verlag. 
ISBN: 978-3-642-12970-4

\bibitem{HPPS-survey}
Christian Haase, Andreas Paffenholz, Lindsay C. Piechnik, Francisco Santos. Existence of unimodular triangulations - positive results. 
%Preprint May 2014, updated December 2017, 89 pages. 
 \emph{Mem. Amer. Math. Soc.}, to appear.
 Available as arXiv preprint \href{https://arxiv.org/abs/1405.1687}{arXiv:1405.16878}
 
\bibitem{HNPS2008}
Christian Haase, Benjamin Nill, Andreas Paffenholz, and Francisco Santos, Lattice points in Minkowski sums, 
Electron J. Combin., 15 (2008), no. 1, Note 11, 5 pp.

\bibitem{mfo2004}
Mini-workshop: Ehrhart Quasipolynomials: Algebra, Combinatorics, and Geometry, Oberwolfach Rep. 1 (2004), no. 3, 2071Ð2101, Abstracts from the mini-workshop held August 15Ð21, 2004, Organized by Jes\'us A.~De Loera and Christian Haase, Oberwolfach Reports. Vol. 1, no. 3. MR MR2144157

\bibitem{mfo2007}
Mini-workshop: Projective normality of smooth toric varieties, Oberwolfach Rep. 4 (2007), no. 39/2007, Abstracts from the mini-workshop held August 12Ð18, 2007. Organized by Christian Haase, Takayuki Hibi and Diane MacLagan.


\bibitem{Oda1997}
Tadao Oda. Problems on Minkowski sums of convex lattice polytopes. 
Abstract submitted at the Oberwolfach Conference ÒCombinatorial Convexity and Algebraic GeometryÓ 26.10--01.11, 1997.
Available as arXiv preprint \href{https://arxiv.org/abs/0812.1418}{arXiv:0812.1418}, 2008.


\end{thebibliography}


\end{document}

